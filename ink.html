<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>百草珍酿学习4课</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background: #000;
      color: #fff;
      overflow: hidden;
      position: fixed;
      width: 100%;
      height: 100%;
    }
    
    /* 加载动画 */
    .loader {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 100;
      width: 100px;
      height: 100px;
    }
    
    .dot {
      width: 15px;
      height: 15px;
      border-radius: 50%;
      position: absolute;
      top: 0;
      bottom: 0;
      left: 0;
      right: 0;
      margin: auto;
    }
    
    .dot-1 {
      background-color: #ffe386;
      animation: dot-1-move 2s ease infinite;
    }
    
    .dot-2 {
      background-color: #10beae;
      animation: dot-2-move 2s ease infinite;
    }
    
    .dot-3 {
      background-color: #f74d75;
      animation: dot-3-move 2s ease infinite;
    }
    
    @keyframes dot-1-move {
      20% { transform: scale(1); }
      45% { transform: translate(16px, 12px) scale(0.45); }
      60% { transform: translate(20px, 15px) scale(0.45); }
      80% { transform: translate(20px, 15px) scale(0.45); }
      100% { transform: translateY(0px) scale(1); }
    }
    
    @keyframes dot-2-move {
      20% { transform: scale(1); }
      45% { transform: translate(-16px, 12px) scale(0.45); }
      60% { transform: translate(-20px, 15px) scale(0.45); }
      80% { transform: translate(-20px, 15px) scale(0.45); }
      100% { transform: translateY(0px) scale(1); }
    }
    
    @keyframes dot-3-move {
      20% { transform: scale(1); }
      45% { transform: translateY(-18px) scale(0.45); }
      60% { transform: translateY(-25px) scale(0.45); }
      80% { transform: translateY(-25px) scale(0.45); }
      100% { transform: translateY(0px) scale(1); }
    }
    
    .loader {
      animation: rotate-move 2s ease-in-out infinite;
    }
    
    @keyframes rotate-move {
      55% { transform: translate(-50%, -50%) rotate(0deg); }
      80% { transform: translate(-50%, -50%) rotate(360deg); }
      100% { transform: translate(-50%, -50%) rotate(360deg); }
    }
    
    /* 播放提示 */
    .play-tip {
      position: fixed;
      bottom: 80px;
      left: 0;
      right: 0;
      text-align: center;
      color: white;
      font-size: 18px;
      text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.8);
      z-index: 99;
      animation: fadeInOut 2s infinite;
      padding: 0 20px;
    }
    
    @keyframes fadeInOut {
      0% { opacity: 0.7; }
      50% { opacity: 1; }
      100% { opacity: 0.7; }
    }
    
    /* 自定义视频播放器 */
    .custom-player {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #000;
      z-index: 90;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    
    .custom-player video {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }
    
    /* 播放按钮 */
    .play-button {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 99;
      background: rgba(0, 0, 0, 0.6);
      color: white;
      border: 2px solid rgba(255, 255, 255, 0.7);
      border-radius: 50%;
      width: 60px;
      height: 60px;
      font-size: 24px;
      cursor: pointer;
      display: flex;
      justify-content: center;
      align-items: center;
      transition: all 0.3s;
    }
    
    .play-button:hover {
      background: rgba(0, 0, 0, 0.8);
      transform: translateX(-50%) scale(1.05);
    }
    
    /* 全屏按钮 */
    .fullscreen-button {
      position: fixed;
      right: 20px;
      bottom: 20px;
      z-index: 99;
      background: rgba(0, 0, 0, 0.6);
      color: white;
      border: 2px solid rgba(255, 255, 255, 0.7);
      border-radius: 50%;
      width: 50px;
      height: 50px;
      font-size: 20px;
      cursor: pointer;
      display: flex;
      justify-content: center;
      align-items: center;
      transition: all 0.3s;
    }
    
    .fullscreen-button:hover {
      background: rgba(0, 0, 0, 0.8);
      transform: scale(1.05);
    }
    
    /* 错误提示 */
    .error-message {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: #fff;
      background: rgba(0, 0, 0, 0.8);
      padding: 20px;
      border-radius: 10px;
      text-align: center;
      z-index: 200;
      display: none;
    }
  </style>
</head>
<body>
  <!-- 加载动画 -->
  <div class="loader">
    <div class="dot dot-1"></div>
    <div class="dot dot-2"></div>
    <div class="dot dot-3"></div>
  </div>
  
  <!-- 播放提示 -->
  <div class="play-tip" id="playTip">请点击下面播放键开始学习</div>
  
  <!-- 自定义视频播放器 -->
  <div class="custom-player" id="customPlayer">
    <video id="videoElement" playsinline webkit-playsinline></video>
  </div>
  
  <!-- 播放按钮 -->
  <button class="play-button" id="playButton">▶</button>
  
  <!-- 全屏按钮 -->
  <button class="fullscreen-button" id="fullscreenButton">⛶</button>
  
  <!-- 错误提示 -->
  <div class="error-message" id="errorMessage"></div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // 获取DOM元素
      const loader = document.querySelector('.loader');
      const playTip = document.getElementById('playTip');
      const customPlayer = document.getElementById('customPlayer');
      const videoElement = document.getElementById('videoElement');
      const playButton = document.getElementById('playButton');
      const fullscreenButton = document.getElementById('fullscreenButton');
      const errorMessage = document.getElementById('errorMessage');
      
      // 获取URL参数
      const urlParams = new URLSearchParams(window.location.search);
      const encodedParam = urlParams.get('c');
      
      if (!encodedParam) {
        showError('无效的视频参数');
        return;
      }
      
      // 解码URL
      let videoUrl;
      try {
        videoUrl = atob(encodedParam);
      } catch (e) {
        showError('视频参数格式错误');
        return;
      }
      
      if (!videoUrl.includes("http")) {
        showError('无效的视频链接');
        return;
      }
      
      // 设置视频源
      videoElement.src = videoUrl;
      
      // 隐藏加载动画
      setTimeout(() => {
        loader.style.display = 'none';
        playTip.style.display = 'block';
        playButton.style.display = 'flex';
        fullscreenButton.style.display = 'flex';
      }, 1500);
      
      // 播放按钮事件
      playButton.addEventListener('click', function() {
        if (videoElement.paused) {
          videoElement.play()
            .then(() => {
              playButton.innerHTML = '❚❚';
              playTip.style.display = 'none';
            })
            .catch(error => {
              showError('播放失败: ' + error.message);
            });
        } else {
          videoElement.pause();
          playButton.innerHTML = '▶';
        }
      });
      
      // 全屏按钮事件
      fullscreenButton.addEventListener('click', toggleFullscreen);
      
      // 视频事件监听
      videoElement.addEventListener('play', function() {
        playButton.innerHTML = '❚❚';
        playTip.style.display = 'none';
      });
      
      videoElement.addEventListener('pause', function() {
        playButton.innerHTML = '▶';
      });
      
      videoElement.addEventListener('ended', function() {
        playButton.innerHTML = '▶';
      });
      
      videoElement.addEventListener('error', function() {
        showError('视频加载失败，请检查链接是否有效');
      });
      
      // 双击切换全屏
      videoElement.addEventListener('dblclick', toggleFullscreen);
      
      // 禁用右键菜单
      videoElement.addEventListener('contextmenu', function(e) {
        e.preventDefault();
        return false;
      });
      
      // 禁用视频下载（尽可能）
      Object.defineProperty(HTMLMediaElement.prototype, 'src', {
        set: function(value) {
          if (this.getAttribute('data-src-set') === 'true') {
            return; // 已经设置过，不允许修改
          }
          this.setAttribute('data-src-set', 'true');
          HTMLMediaElement.prototype.src.set.call(this, value);
        }
      });
      
      // 全屏功能
      function toggleFullscreen() {
        if (!document.fullscreenElement) {
          if (videoElement.requestFullscreen) {
            videoElement.requestFullscreen().catch(err => {
              console.error('全屏错误:', err);
            });
          } else if (videoElement.webkitRequestFullscreen) {
            videoElement.webkitRequestFullscreen();
          } else if (videoElement.msRequestFullscreen) {
            videoElement.msRequestFullscreen();
          }
        } else {
          if (document.exitFullscreen) {
            document.exitFullscreen();
          } else if (document.webkitExitFullscreen) {
            document.webkitExitFullscreen();
          } else if (document.msExitFullscreen) {
            document.msExitFullscreen();
          }
        }
      }
      
      // 错误处理
      function showError(message) {
        loader.style.display = 'none';
        errorMessage.textContent = message;
        errorMessage.style.display = 'block';
        console.error(message);
      }
      
      console.log('视频URL:', videoUrl);
    });
  </script>
</body>
</html>
