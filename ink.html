<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" name="viewport">
  <meta content="yes" name="apple-mobile-web-app-capable">
  <meta content="yes" name="apple-touch-fullscreen">
  <meta content="black" name="apple-mobile-web-app-status-bar-style">
  <meta content="320" name="MobileOptimized">
  <meta content="true" name="HandheldFriendly">
  <meta name="mobile-web-app-capable" content="yes">

  <title>ç”Ÿ88è¯¾</title>

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background: #000;
      color: white;
      overflow: hidden;
      position: fixed;
      width: 100%;
      height: 100%;
    }
    
    .container {
      width: 100px;
      height: 100px;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 100;
    }

    .dot {
      width: 15px;
      height: 15px;
      border-radius: 50%;
      background-color: #000;
      position: absolute;
      top: 0;
      bottom: 0;
      left: 0;
      right: 0;
      margin: auto;
    }

    .dot-3 {
      background-color: #f74d75;
      animation: dot-3-move 2s ease infinite;
    }

    @keyframes dot-3-move {
      20% { transform: scale(1) }
      45% { transform: translateY(-18px) scale(.45) }
      60% { transform: translateY(-25px) scale(.45) }
      80% { transform: translateY(-25px) scale(.45) }
      100% { transform: translateY(0px) scale(1) }
    }

    .dot-2 {
      background-color: #10beae;
      animation: dot-2-move 2s ease infinite;
    }

    .dot-1 {
      background-color: #ffe386;
      animation: dot-1-move 2s ease infinite;
    }

    @keyframes dot-2-move {
      20% { transform: scale(1) }
      45% { transform: translate(-16px, 12px) scale(.45) }
      60% { transform: translate(-20px, 15px) scale(.45) }
      80% { transform: translate(-20px, 15px) scale(.45) }
      100% { transform: translateY(0px) scale(1) }
    }

    @keyframes dot-1-move {
      20% { transform: scale(1) }
      45% { transform: translate(16px, 12px) scale(.45) }
      60% { transform: translate(20px, 15px) scale(.45) }
      80% { transform: translate(20px, 15px) scale(.45) }
      100% { transform: translateY(0px) scale(1) }
    }

    .container {
      animation: rotate-move 2s ease-in-out infinite;
    }

    @keyframes rotate-move {
      55% { transform: translate(-50%, -50%) rotate(0deg) }
      80% { transform: translate(-50%, -50%) rotate(360deg) }
      100% { transform: translate(-50%, -50%) rotate(360deg) }
    }
    
    .content {
      height: 100%;
      width: 100%;
      position: fixed;
      left: 0;
      top: 0;
      border: none;
      background: #000;
      -webkit-overflow-scrolling: touch;
      overflow: auto;
      z-index: 2;
    }
    
    /* è‡ªå®šä¹‰å…¨å±æŒ‰é’® */
    .fullscreen-button {
      position: fixed;
      right: 20px;
      bottom: 20px;
      z-index: 9999;
      background: rgba(0, 0, 0, 0.7);
      color: white;
      border: 1px solid rgba(255, 255, 255, 0.5);
      border-radius: 20px;
      padding: 12px 20px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      display: none;
      transition: all 0.3s ease;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
    }
    
    .fullscreen-button:hover {
      background: rgba(0, 0, 0, 0.9);
      transform: scale(1.05);
    }
    
    /* æ§åˆ¶é¢æ¿ */
    .control-panel {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);
      padding: 15px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      z-index: 9998;
      display: none;
    }
    
    .progress-container {
      flex-grow: 1;
      height: 4px;
      background: rgba(255, 255, 255, 0.3);
      border-radius: 2px;
      margin: 0 15px;
      cursor: pointer;
      position: relative;
    }
    
    .progress-bar {
      height: 100%;
      background: #f74d75;
      border-radius: 2px;
      width: 0%;
    }
    
    .time-display {
      font-size: 14px;
      color: #ddd;
      min-width: 100px;
      text-align: center;
    }
    
    .control-btn {
      background: none;
      border: none;
      color: white;
      font-size: 18px;
      cursor: pointer;
      padding: 5px 10px;
    }
    
    /* é”™è¯¯æç¤º */
    .error-message {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0, 0, 0, 0.8);
      padding: 20px;
      border-radius: 10px;
      text-align: center;
      z-index: 10000;
      display: none;
    }
    
    .error-message button {
      margin-top: 15px;
      padding: 8px 15px;
      background: #f74d75;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    
    /* æ¨¡å¼é€‰æ‹©å™¨ */
    .mode-selector {
      position: fixed;
      right: 20px;
      bottom: 70px;
      background: rgba(0, 0, 0, 0.7);
      border-radius: 10px;
      padding: 10px;
      z-index: 9997;
      display: none;
      flex-direction: column;
    }
    
    .mode-btn {
      background: rgba(255, 255, 255, 0.1);
      border: none;
      color: white;
      padding: 8px 12px;
      margin: 5px 0;
      border-radius: 5px;
      cursor: pointer;
      text-align: left;
    }
    
    .mode-btn.active {
      background: rgba(247, 77, 117, 0.5);
    }
    
    /* åŠ è½½æç¤º */
    .loading-text {
      position: fixed;
      top: 60%;
      left: 0;
      width: 100%;
      text-align: center;
      color: #aaa;
      font-size: 14px;
      z-index: 101;
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="dot dot-1"></div>
    <div class="dot dot-2"></div>
    <div class="dot dot-3"></div>
  </div>
  <div class="loading-text">æ­£åœ¨åŠ è½½è§†é¢‘å†…å®¹ï¼Œè¯·ç¨å€™...</div>
  
  <button class="fullscreen-button" id="fullscreenBtn">å…¨å±æ’­æ”¾</button>
  
  <div class="mode-selector" id="modeSelector">
    <button class="mode-btn active" data-mode="iframe">ç½‘é¡µæ¨¡å¼ï¼ˆå…¼å®¹ï¼‰</button>
    <button class="mode-btn" data-mode="direct">ç›´æ¥æ’­æ”¾ï¼ˆçº¯å‡€ï¼‰</button>
  </div>
  
  <div class="control-panel" id="controlPanel">
    <button class="control-btn" id="playPauseBtn">â¸ï¸</button>
    <div class="progress-container" id="progressContainer">
      <div class="progress-bar" id="progressBar"></div>
    </div>
    <div class="time-display" id="timeDisplay">00:00 / 00:00</div>
    <button class="control-btn" id="soundBtn">ğŸ”Š</button>
  </div>
  
  <div class="error-message" id="errorMessage">
    <p>è§†é¢‘åŠ è½½å¤±è´¥ï¼Œè¯·å°è¯•åˆ‡æ¢æ’­æ”¾æ¨¡å¼</p>
    <button id="retryBtn">é‡è¯•</button>
  </div>

  <script>
    // è·å–URLå‚æ•°
    var urlParams = new URLSearchParams(window.location.search);
    var encodedParam = urlParams.get('c');
    var trueurl = encodedParam ? atob(encodedParam) : '';
    
    // è·å–DOMå…ƒç´ 
    var fullscreenBtn = document.getElementById('fullscreenBtn');
    var modeSelector = document.getElementById('modeSelector');
    var controlPanel = document.getElementById('controlPanel');
    var errorMessage = document.getElementById('errorMessage');
    var retryBtn = document.getElementById('retryBtn');
    var playPauseBtn = document.getElementById('playPauseBtn');
    var progressContainer = document.getElementById('progressContainer');
    var progressBar = document.getElementById('progressBar');
    var timeDisplay = document.getElementById('timeDisplay');
    var soundBtn = document.getElementById('soundBtn');
    
    // å…¨å±€å˜é‡
    var currentMode = 'iframe';
    var videoElement = null;
    var isPlaying = false;
    var isFullscreen = false;
    
    // åˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', function() {
      if (trueurl && trueurl.includes("http")) {
        initPlayer();
      } else {
        showError("æ— æ•ˆçš„è§†é¢‘é“¾æ¥å‚æ•°");
      }
    });
    
    // åˆå§‹åŒ–æ’­æ”¾å™¨
    function initPlayer() {
      // éšè—åŠ è½½åŠ¨ç”»
      setTimeout(function() {
        document.querySelector(".container").style.display = "none";
        document.querySelector(".loading-text").style.display = "none";
      }, 1500);
      
      // åˆ›å»ºiframe
      createIframePlayer();
      
      // æ˜¾ç¤ºå…¨å±æŒ‰é’®
      setTimeout(function() {
        fullscreenBtn.style.display = 'block';
      }, 2000);
      
      // äº‹ä»¶ç›‘å¬
      fullscreenBtn.addEventListener('click', toggleFullscreen);
      retryBtn.addEventListener('click', retryPlayback);
      
      // æ·»åŠ æ¨¡å¼é€‰æ‹©æŒ‰é’®äº‹ä»¶
      var modeButtons = document.querySelectorAll('.mode-btn');
      modeButtons.forEach(function(btn) {
        btn.addEventListener('click', function() {
          modeButtons.forEach(b => b.classList.remove('active'));
          this.classList.add('active');
          switchMode(this.dataset.mode);
        });
      });
      
      // æ·»åŠ æ§åˆ¶é¢æ¿äº‹ä»¶
      playPauseBtn.addEventListener('click', togglePlayPause);
      progressContainer.addEventListener('click', seekVideo);
      soundBtn.addEventListener('click', toggleMute);
    }
    
    // åˆ›å»ºiframeæ’­æ”¾å™¨
    function createIframePlayer() {
      var iframe = document.createElement('iframe');
      iframe.className = 'content';
      iframe.id = 'videoIframe';
      iframe.setAttribute('allowfullscreen', '');
      iframe.setAttribute('webkitallowfullscreen', '');
      iframe.setAttribute('mozallowfullscreen', '');
      iframe.setAttribute('allow', 'autoplay; fullscreen; accelerometer; gyroscope; encrypted-media; picture-in-picture');
      iframe.setAttribute('frameborder', '0');
      iframe.setAttribute('scrolling', 'no');
      
      iframe.onload = function() {
        try {
          // å°è¯•æ³¨å…¥CSSæ¥éšè—ä¸éœ€è¦çš„å…ƒç´ 
          injectIframeStyles(iframe);
        } catch(e) {
          console.log('æ— æ³•æ³¨å…¥æ ·å¼:', e);
        }
      };
      
      iframe.onerror = function() {
        showError("iframeåŠ è½½å¤±è´¥");
      };
      
      iframe.src = trueurl;
      document.body.appendChild(iframe);
    }
    
    // åˆ›å»ºç›´æ¥è§†é¢‘æ’­æ”¾å™¨
    function createDirectVideoPlayer() {
      // å…ˆç§»é™¤iframe
      var iframe = document.getElementById('videoIframe');
      if (iframe) iframe.remove();
      
      // åˆ›å»ºvideoå…ƒç´ 
      videoElement = document.createElement('video');
      videoElement.id = 'directVideo';
      videoElement.className = 'content';
      videoElement.controls = false;
      videoElement.autoplay = true;
      videoElement.playsInline = true;
      
      // æ·»åŠ æº
      var source = document.createElement('source');
      source.src = trueurl;
      source.type = 'video/mp4';
      videoElement.appendChild(source);
      
      // æ·»åŠ äº‹ä»¶
      videoElement.addEventListener('loadedmetadata', function() {
        updateTimeDisplay();
      });
      
      videoElement.addEventListener('timeupdate', function() {
        updateProgress();
      });
      
      videoElement.addEventListener('play', function() {
        isPlaying = true;
        playPauseBtn.textContent = 'â¸ï¸';
      });
      
      videoElement.addEventListener('pause', function() {
        isPlaying = false;
        playPauseBtn.textContent = 'â–¶ï¸';
      });
      
      videoElement.addEventListener('error', function() {
        showError("è§†é¢‘åŠ è½½å¤±è´¥ï¼Œè¯·ä½¿ç”¨ç½‘é¡µæ¨¡å¼");
      });
      
      videoElement.addEventListener('click', function() {
        controlPanel.style.display = 'flex';
        setTimeout(function() {
          if (isPlaying) controlPanel.style.display = 'none';
        }, 3000);
      });
      
      document.body.appendChild(videoElement);
      
      // æ˜¾ç¤ºæ§åˆ¶é¢æ¿
      controlPanel.style.display = 'flex';
    }
    
    // åˆ‡æ¢æ’­æ”¾æ¨¡å¼
    function switchMode(mode) {
      if (mode === currentMode) return;
      
      currentMode = mode;
      
      if (mode === 'direct') {
        createDirectVideoPlayer();
      } else {
        createIframePlayer();
        controlPanel.style.display = 'none';
      }
    }
    
    // æ³¨å…¥iframeæ ·å¼
    function injectIframeStyles(iframe) {
      try {
        var style = document.createElement('style');
        style.textContent = `
          body > *:not(.content):not(script):not(style) {
            display: none !important;
            visibility: hidden !important;
          }
          body, html {
            overflow: hidden !important;
            background: #000 !important;
            width: 100% !important;
            height: 100% !important;
          }
          video {
            object-fit: contain !important;
            width: 100% !important;
            height: 100% !important;
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            z-index: 9999 !important;
          }
        `;
        
        iframe.contentDocument.head.appendChild(style);
      } catch(e) {
        console.log('æ ·å¼æ³¨å…¥å¤±è´¥:', e);
      }
    }
    
    // åˆ‡æ¢å…¨å±
    function toggleFullscreen() {
      if (!isFullscreen) {
        // è¿›å…¥å…¨å±
        var elem = document.documentElement;
        
        if (elem.requestFullscreen) {
          elem.requestFullscreen();
        } else if (elem.webkitRequestFullscreen) {
          elem.webkitRequestFullscreen();
        } else if (elem.msRequestFullscreen) {
          elem.msRequestFullscreen();
        }
        
        fullscreenBtn.textContent = 'é€€å‡ºå…¨å±';
        modeSelector.style.display = 'flex';
        
        // æ¨ªå±æç¤º
        if (window.screen.orientation && window.screen.orientation.lock) {
          window.screen.orientation.lock('landscape').catch(function(error) {
            console.log('æ¨ªå±é”å®šå¤±è´¥:', error);
          });
        }
      } else {
        // é€€å‡ºå…¨å±
        if (document.exitFullscreen) {
          document.exitFullscreen();
        } else if (document.webkitExitFullscreen) {
          document.webkitExitFullscreen();
        } else if (document.msExitFullscreen) {
          document.msExitFullscreen();
        }
        
        fullscreenBtn.textContent = 'å…¨å±æ’­æ”¾';
        modeSelector.style.display = 'none';
        
        // ç«–å±æç¤º
        if (window.screen.orientation && window.screen.orientation.unlock) {
          window.screen.orientation.unlock();
        }
      }
      
      isFullscreen = !isFullscreen;
    }
    
    // åˆ‡æ¢æ’­æ”¾/æš‚åœ
    function togglePlayPause() {
      if (currentMode === 'direct' && videoElement) {
        if (videoElement.paused) {
          videoElement.play();
          playPauseBtn.textContent = 'â¸ï¸';
        } else {
          videoElement.pause();
          playPauseBtn.textContent = 'â–¶ï¸';
        }
      }
    }
    
    // è§†é¢‘è·³è½¬
    function seekVideo(e) {
      if (currentMode === 'direct' && videoElement) {
        var percent = e.offsetX / progressContainer.offsetWidth;
        videoElement.currentTime = percent * videoElement.duration;
        updateProgress();
      }
    }
    
    // åˆ‡æ¢é™éŸ³
    function toggleMute() {
      if (currentMode === 'direct' && videoElement) {
        videoElement.muted = !videoElement.muted;
        soundBtn.textContent = videoElement.muted ? 'ğŸ”‡' : 'ğŸ”Š';
      }
    }
    
    // æ›´æ–°è¿›åº¦æ¡
    function updateProgress() {
      if (currentMode === 'direct' && videoElement) {
        var value = (videoElement.currentTime / videoElement.duration) * 100;
        progressBar.style.width = value + '%';
        updateTimeDisplay();
      }
    }
    
    // æ›´æ–°æ—¶é—´æ˜¾ç¤º
    function updateTimeDisplay() {
      if (currentMode === 'direct' && videoElement) {
        var currentTime = formatTime(videoElement.currentTime);
        var duration = formatTime(videoElement.duration);
        timeDisplay.textContent = currentTime + ' / ' + duration;
      }
    }
    
    // æ ¼å¼åŒ–æ—¶é—´
    function formatTime(seconds) {
      var min = Math.floor(seconds / 60);
      var sec = Math.floor(seconds % 60);
      return min.toString().padStart(2, '0') + ':' + sec.toString().padStart(2, '0');
    }
    
    // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
    function showError(message) {
      errorMessage.querySelector('p').textContent = message;
      errorMessage.style.display = 'block';
    }
    
    // é‡è¯•æ’­æ”¾
    function retryPlayback() {
      errorMessage.style.display = 'none';
      if (currentMode === 'direct') {
        createDirectVideoPlayer();
      } else {
        createIframePlayer();
      }
    }
    
    // ç›‘å¬å…¨å±å˜åŒ–
    document.addEventListener('fullscreenchange', handleFullscreenChange);
    document.addEventListener('webkitfullscreenchange', handleFullscreenChange);
    document.addEventListener('mozfullscreenchange', handleFullscreenChange);
    document.addEventListener('MSFullscreenChange', handleFullscreenChange);
    
    function handleFullscreenChange() {
      isFullscreen = !!(document.fullscreenElement || document.webkitFullscreenElement || 
                        document.mozFullScreenElement || document.msFullscreenElement);
      
      fullscreenBtn.textContent = isFullscreen ? 'é€€å‡ºå…¨å±' : 'å…¨å±æ’­æ”¾';
      modeSelector.style.display = isFullscreen ? 'flex' : 'none';
    }
  </script>
</body>
</html>
